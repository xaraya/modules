<xar:template xmlns:xar="http://xaraya.com/2004/blocklayout">
    <xar:calendar-decorator object="$MonthCal" decorator="Xaraya" name="MonthURI" />
    <xar:calendar-decorator object="$MonthCal" decorator="Textual" name="MonthText" />
    <xar:set name="monthtitle">#$MonthText->thisMonthName('long')#</xar:set>
    <xar:set name="prevMonthTitle"><xar:mlstring>Previous Month</xar:mlstring></xar:set>
    <xar:set name="prevMonthURL">#$MonthURI->prev('month')#</xar:set>
    <xar:set name="nextMonthTitle"><xar:mlstring>Next Month</xar:mlstring></xar:set>
    <xar:set name="nextMonthURL">#$MonthURI->next('month')#</xar:set>
    <table width="170" border="0" cellpadding="3" cellspacing="0" class="calborder">
        <tr>
            <td align="left" class="sideback"><div style="height:16px;"><b><a style="text-decoration: none;" href="#$prevMonthURL#" title="#$prevMonthTitle#">&lt;&lt;</a></b></div></td>
            <td align="center" class="sideback"><div style="height:16px;"><b>#$monthtitle#</b></div></td>
            <td align="right" class="sideback"><div style="height:16px;"><b><a style="text-decoration: none;" href="#$nextMonthURL#" title="#$nextMonthTitle#">&gt;&gt;</a></b></div></td>
        </tr>
        <tr>
            <td colspan="3" align="center">
                <table border="0" cellspacing="0" cellpadding="0">
                    <tr align="center">
                        <xar:set name="weekdays">$MonthText->orderedWeekdays('one')</xar:set>
                        <xar:foreach in="$weekdays" value="$dayName">
                            <td style="width: 22px"><b>#$dayName#</b></td>
                        </xar:foreach>
                    </tr>
                    <xar:set name="Day">$MonthCal->fetch()</xar:set>
                    <xar:while condition="$Day">
                        <xar:set name="WeekDate">xarLocaleFormatDate('%Y%m%d',$Day->getTimeStamp())</xar:set>
                        <xar:calendar-decorator object="$Day" decorator="Xaraya" name="DayURI" />
                        <xar:if condition="$Day:isFirst()">
                            <tr>
                                <xar:while condition="1">                        
                                    <xar:if condition="$Day:isSelected()">
                                        <td class="selected"><a href="#xarServer::getCurrentURL(array('cal_date'=>$WeekDate))#">#$Day:thisDay()#</a></td>
                                    <xar:elseif condition="$Day:isEmpty()" />
                                        <td>&#160;</td>
                                    <xar:else />
                                        <td class="xar-accent"><a href="#xarServer::getCurrentURL(array('cal_date'=>$WeekDate))#">#$Day:thisDay()#</a></td>
                                    </xar:if>
                                    <xar:if condition="$Day:isLast()">
                                        <xar:break />
                                    </xar:if>
                                    <xar:set name="Day">$MonthCal->fetch()</xar:set>
                                </xar:while>                            
                            </tr>
                        </xar:if>
                        <xar:set name="Day">$MonthCal->fetch()</xar:set>
                    </xar:while>
                </table>
            </td>
        </tr>
    </table>
</xar:template>